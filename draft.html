<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Schweinis Chaos-Logbuch üê∑‚ö°</title>
    
    <!-- Tailwind CSS (Styling) -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Font: Gochi Hand (Frech & Handgeschrieben) -->
    <link href="https://fonts.googleapis.com/css2?family=Gochi+Hand&display=swap" rel="stylesheet">
    
    <!-- Icons (Lucide) -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        /* --------------------------------------------------
           THEME & DESIGN
        -------------------------------------------------- */
        :root {
            --font-hand: 'Gochi Hand', cursive;
            --color-primary: #14b8a6; /* Teal 500 */
            --color-bg: #f0fdfa; /* Teal 50 */
            --color-accent: #ccfbf1; /* Teal 100 */
        }

        body {
            font-family: ui-sans-serif, system-ui, sans-serif;
            background-color: var(--color-bg);
            -webkit-tap-highlight-color: transparent;
        }
        
        h1, h2, h3, .font-hand {
            font-family: var(--font-hand);
        }

        /* Versteckte Scrollbar f√ºr cleanen Look */
        .hide-scrollbar::-webkit-scrollbar { display: none; }
        .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }

        /* Klick-Feedback */
        .photo-card:active { transform: scale(0.98); }
        .btn-press:active { transform: scale(0.95); }

        /* Der "Chaos-Schatten" */
        .chaos-shadow { 
            box-shadow: 4px 4px 0px 0px rgba(20, 184, 166, 0.4); 
            transition: all 0.2s;
        }
        
        /* Animierte Tape-Streifen */
        .tape {
            background-color: rgba(253, 224, 71, 0.8); /* Yellow-300 */
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            backdrop-filter: blur(2px);
        }

        /* Modal Animation */
        .modal-enter {
            animation: modalPop 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
        }
        @keyframes modalPop {
            0% { transform: scale(0.8); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>
<body class="text-gray-700 selection:bg-teal-200">

    <!-- Header / Navigationsleiste -->
    <header class="fixed top-0 w-full z-50 bg-white/95 backdrop-blur-md border-b-2 border-teal-100">
        <div class="max-w-md mx-auto px-4 h-16 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-10 h-10 bg-teal-100 rounded-full flex items-center justify-center text-xl border-2 border-teal-500 transform -rotate-6 shadow-sm">
                    üê∑
                </div>
                <h1 class="text-2xl text-teal-600 tracking-wide font-hand font-bold mt-1">Chaos Logbuch</h1>
            </div>
            <button onclick="window.scrollTo({ top: 0, behavior: 'smooth' })" class="bg-teal-50 p-2 rounded-full text-teal-500 hover:bg-teal-100 transition border border-teal-200">
                <i data-lucide="arrow-up" class="w-5 h-5"></i>
            </button>
        </div>
    </header>

    <!-- Hauptinhalt -->
    <main id="app" class="max-w-md mx-auto pt-24 pb-12 px-4 space-y-8">
        
        <!-- Profil Karte -->
        <div class="bg-white rounded-2xl p-6 chaos-shadow border-2 border-teal-500 text-center relative overflow-visible mt-4">
            <div class="absolute -top-3 -left-8 w-32 h-8 tape transform -rotate-12"></div>
            <div class="absolute -bottom-3 -right-8 w-32 h-8 tape transform -rotate-12"></div>

            <div class="w-28 h-28 mx-auto mb-4 rounded-full bg-teal-100 border-4 border-teal-300 p-1 relative transform rotate-2 shadow-lg">
                <img src="https://images.unsplash.com/photo-1596700096996-2580556ce650?q=80&w=400&auto=format&fit=crop" 
                     class="w-full h-full object-cover rounded-full grayscale contrast-125" alt="Profilbild Schweini">
                <div class="absolute bottom-0 right-0 bg-white rounded-full p-1 border-2 border-teal-200 text-lg">üè¥‚Äç‚ò†Ô∏è</div>
            </div>
            
            <h2 class="text-3xl font-hand text-teal-700 font-bold mb-1">Ahoi Elisa! üíÄ</h2>
            <p class="font-hand text-xl text-gray-500 transform -rotate-1">"Ich hab nix gemacht!"</p>
            
            <div class="mt-4 flex justify-center gap-2 text-sm font-bold font-hand">
                <span class="bg-yellow-100 text-yellow-800 px-3 py-1 rounded-full border border-yellow-400 transform -rotate-2">
                    Chaos-Level: 9000 ‚ö°
                </span>
            </div>
        </div>

        <!-- Feed Container -->
        <div id="feed-container" class="space-y-10">
            <!-- Wird per Javascript bef√ºllt -->
        </div>

    </main>

    <!-- IDENTITY MODAL (Wer bist du?) -->
    <div id="identity-modal" class="fixed inset-0 bg-teal-900/40 z-[80] hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white w-full max-w-sm rounded-3xl p-6 chaos-shadow border-2 border-teal-500 relative modal-enter">
            <!-- Close Button -->
            <button onclick="closeIdentityModal()" class="absolute top-3 right-3 text-gray-400 hover:text-red-500 p-2">
                <i data-lucide="x" class="w-6 h-6"></i>
            </button>

            <h3 class="text-2xl font-hand font-bold text-center text-teal-700 mb-6 mt-2">Wer schreibt da? ‚úèÔ∏è</h3>

            <!-- Grid Layout -->
            <div class="grid grid-cols-2 gap-3">
                <!-- Elisa (Prominent) -->
                <button onclick="selectIdentity('Elisa')" class="col-span-2 bg-gradient-to-r from-teal-100 to-teal-200 p-4 rounded-xl border-2 border-teal-300 flex items-center justify-center gap-3 hover:scale-[1.02] transition shadow-sm group btn-press">
                    <span class="text-3xl group-hover:rotate-12 transition transform">üë±‚Äç‚ôÄÔ∏è</span>
                    <span class="font-hand font-bold text-2xl text-teal-800">Elisa</span>
                </button>

                <!-- Die anderen -->
                <button onclick="selectIdentity('Mama')" class="bg-pink-50 p-3 rounded-xl border-2 border-pink-200 flex flex-col items-center gap-1 hover:bg-pink-100 transition btn-press">
                    <span class="text-2xl">üë©üèΩ</span>
                    <span class="font-hand font-bold text-pink-700">Mama</span>
                </button>
                <button onclick="selectIdentity('Papa')" class="bg-blue-50 p-3 rounded-xl border-2 border-blue-200 flex flex-col items-center gap-1 hover:bg-blue-100 transition btn-press">
                    <span class="text-2xl">üßî</span>
                    <span class="font-hand font-bold text-blue-700">Papa</span>
                </button>
                <button onclick="selectIdentity('Oma')" class="bg-purple-50 p-3 rounded-xl border-2 border-purple-200 flex flex-col items-center gap-1 hover:bg-purple-100 transition btn-press">
                    <span class="text-2xl">üëµ</span>
                    <span class="font-hand font-bold text-purple-700">Oma</span>
                </button>
                <button onclick="selectIdentity('Opa')" class="bg-green-50 p-3 rounded-xl border-2 border-green-200 flex flex-col items-center gap-1 hover:bg-green-100 transition btn-press">
                    <span class="text-2xl">üë¥</span>
                    <span class="font-hand font-bold text-green-700">Opa</span>
                </button>
                
                <!-- Letzte Reihe geteilt: Wonkel & Schweini -->
                <button onclick="selectIdentity('Wonkel')" class="bg-yellow-50 p-3 rounded-xl border-2 border-yellow-200 flex flex-col items-center gap-1 hover:bg-yellow-100 transition btn-press">
                    <span class="text-2xl">ü§†</span>
                    <span class="font-hand font-bold text-yellow-800">Wonkel</span>
                </button>
                
                <button onclick="selectIdentity('Schweini')" class="bg-teal-50 p-3 rounded-xl border-2 border-teal-200 flex flex-col items-center gap-1 hover:bg-teal-100 transition btn-press">
                    <span class="text-2xl">üê∑</span>
                    <span class="font-hand font-bold text-teal-600">Schweini</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Fullscreen Bildanzeige (Lightbox) -->
    <div id="lightbox" class="fixed inset-0 bg-teal-900/95 z-[100] hidden flex items-center justify-center p-4 backdrop-blur-sm" onclick="closeLightbox()">
        <img id="lightbox-img" src="" class="max-w-full max-h-[80vh] rounded-lg shadow-2xl transition-transform duration-300 transform scale-95 opacity-0 border-4 border-white rotate-1">
        <button class="absolute top-6 right-6 text-white bg-white/20 p-3 rounded-full hover:bg-white/30 backdrop-blur-md transition">
            <i data-lucide="x" class="w-8 h-8"></i>
        </button>
    </div>

    <!-- JAVASCRIPT BEREICH -->
    <script>
        lucide.createIcons();

        // ---------------------------------------------------------
        // DATEN (Hier bearbeiten)
        // ---------------------------------------------------------
        
        const entries = [
            {
                id: 1,
                date: "Heute, 08:30 Uhr",
                mood: "Frech üòú",
                title: "Der Keks-Raubzug",
                text: "Elisa, du glaubst nicht, was passiert ist! Die Keksdose stand einfach OFFEN auf dem Tisch. \n\nIch wollte sie nur besch√ºtzen, damit keine Fliegen reinkommen. Dabei bin ich *ganz aus Versehen* mit der Schnauze in einen Schokokeks gefallen. Oma hat gelacht, aber Opa hat seinen Keks gesucht. Ups.",
                images: [
                    "https://images.unsplash.com/photo-1558961363-fa8fdf82db35?q=80&w=500", 
                    "https://images.unsplash.com/photo-1599508704512-2f19efd1e35f?q=80&w=500" 
                ],
                reactions: { 'üê∑': 5, 'üç™': 12, 'ü§¶‚Äç‚ôÄÔ∏è': 3 }, 
                comments: [
                    { name: "Oma", text: "Du kleiner Kr√ºmel-R√§uber!" }
                ]
            },
            {
                id: 2,
                date: "Gestern, 15:00 Uhr",
                mood: "Wild ü§†",
                title: "Rodeo im Wohnzimmer",
                text: "Ich habe den Staubsaug-Roboter gez√§hmt! Er hei√üt jetzt 'R√ºdiger' und ist mein Pferd. Wir sind drei Runden durchs Wohnzimmer geritten, bis wir gegen das Sofa geknallt sind. Mir geht es gut, aber R√ºdiger piept komisch.",
                images: [
                    "https://images.unsplash.com/photo-1518640467707-6811f4a6ab73?q=80&w=500" 
                ],
                reactions: { 'ü§£': 8, 'üêé': 4 },
                comments: []
            }
        ];


        // ---------------------------------------------------------
        // RENDER LOGIK
        // ---------------------------------------------------------

        const feedContainer = document.getElementById('feed-container');

        function renderFeed() {
            feedContainer.innerHTML = '';
            
            entries.forEach(entry => {
                const html = `
                    <article class="bg-white rounded-2xl chaos-shadow border-2 border-teal-500 overflow-hidden relative" id="post-${entry.id}">
                        <div class="absolute -top-3 left-1/2 transform -translate-x-1/2 w-40 h-8 tape rotate-1 z-10 opacity-90"></div>

                        <div class="p-6 pt-8 pb-4">
                            <div class="flex justify-between items-center mb-4 font-hand font-bold text-lg">
                                <span class="text-teal-600 bg-teal-50 px-3 py-1 rounded-lg border border-teal-200 transform -rotate-1">
                                    ${entry.date}
                                </span>
                                <span class="text-yellow-700 bg-yellow-50 px-3 py-1 rounded-lg border border-yellow-200 transform rotate-2">
                                    ${entry.mood}
                                </span>
                            </div>

                            <h3 class="text-2xl font-hand font-bold text-gray-800 mb-3 leading-tight">${entry.title}</h3>
                            <p class="text-gray-600 leading-relaxed whitespace-pre-line text-[1.05rem]">${entry.text}</p>
                        </div>

                        ${renderImages(entry.images)}

                        <div class="bg-gray-50 p-4 border-t-2 border-teal-100">
                            <div class="flex flex-wrap gap-2 mb-4">
                                ${renderReactionBtn(entry.id, 'üê∑', entry.reactions['üê∑'])}
                                ${renderReactionBtn(entry.id, 'ü§£', entry.reactions['ü§£'])}
                                ${renderReactionBtn(entry.id, 'ü§¶‚Äç‚ôÄÔ∏è', entry.reactions['ü§¶‚Äç‚ôÄÔ∏è'])}
                                ${renderReactionBtn(entry.id, 'üí©', entry.reactions['üí©'])}
                            </div>

                            <div class="space-y-3" id="comments-area-${entry.id}">
                                ${entry.comments.map(c => renderCommentHtml(c.name, c.text)).join('')}
                            </div>

                            <form onsubmit="initCommentProcess(event, ${entry.id})" class="mt-4 flex gap-2 relative">
                                <input type="text" name="text" placeholder="Antworte Schweini..." autocomplete="off"
                                       class="w-full bg-white border-2 border-teal-200 rounded-full px-4 py-2 pr-12 focus:outline-none focus:border-teal-500 font-hand text-lg placeholder:text-gray-400">
                                <button type="submit" class="absolute right-1 top-1 bottom-1 bg-teal-500 text-white w-10 rounded-full flex items-center justify-center hover:bg-teal-600 transition btn-press">
                                    <i data-lucide="send" class="w-4 h-4 ml-0.5"></i>
                                </button>
                            </form>
                        </div>
                    </article>
                `;
                feedContainer.innerHTML += html;
            });
            lucide.createIcons();
        }

        function renderImages(images) {
            if (!images || images.length === 0) return '';
            const gridClass = images.length === 1 ? 'grid-cols-1' : 'grid-cols-2';
            return `
                <div class="px-3 pb-3">
                    <div class="grid ${gridClass} gap-2">
                        ${images.map(src => `
                            <div class="aspect-square relative group overflow-hidden rounded-xl border-2 border-gray-100 cursor-pointer" onclick="openLightbox('${src}')">
                                <img src="${src}" class="w-full h-full object-cover transition duration-500 group-hover:scale-110 group-hover:rotate-1" alt="Foto">
                            </div>
                        `).join('')}
                    </div>
                </div>
            `;
        }

        function renderReactionBtn(id, emoji, count = 0) {
            return `
                <button onclick="clickReaction(this, '${emoji}')" 
                        class="btn-press flex items-center gap-1.5 bg-white px-3 py-1.5 rounded-full border-2 border-teal-100 shadow-sm hover:border-teal-300 transition select-none">
                    <span class="text-xl leading-none filter drop-shadow-sm">${emoji}</span>
                    <span class="font-hand font-bold text-teal-600 count-val">${count > 0 ? count : ''}</span>
                </button>
            `;
        }

        function renderCommentHtml(name, text) {
            // Standard (Schweini, Elisa, etc.)
            let borderClass = 'border-teal-300';
            let bgDot = 'bg-teal-500';
            let nameColor = 'text-teal-600';

            if(name === 'Mama') { borderClass = 'border-pink-300'; bgDot = 'bg-pink-500'; nameColor = 'text-pink-600'; }
            if(name === 'Papa') { borderClass = 'border-blue-300'; bgDot = 'bg-blue-500'; nameColor = 'text-blue-600'; }
            if(name === 'Wonkel') { borderClass = 'border-yellow-300'; bgDot = 'bg-yellow-500'; nameColor = 'text-yellow-700'; }
            if(name.startsWith('O')) { borderClass = 'border-purple-300'; bgDot = 'bg-purple-500'; nameColor = 'text-purple-600'; } // Oma/Opa

            return `
                <div class="bg-white p-3 rounded-xl border ${borderClass} text-sm shadow-sm relative ml-2 animate-[pulse_0.5s_ease-out]">
                    <div class="absolute w-3 h-3 ${bgDot} rounded-full -left-4 top-4 border border-white shadow-sm"></div>
                    <span class="font-hand font-bold ${nameColor} text-base mr-1">${name}:</span>
                    <span class="text-gray-700">${text}</span>
                </div>
            `;
        }

        // ---------------------------------------------------------
        // SOCIAL LOGIK (Modal & Identity)
        // ---------------------------------------------------------
        
        let pendingCommentData = null; // Speichert Text und Entry ID zwischen

        function initCommentProcess(e, id) {
            e.preventDefault();
            const input = e.target.text;
            const text = input.value.trim();
            
            if (!text) return;

            // Daten zwischenspeichern
            pendingCommentData = { id: id, text: text, inputField: input };
            
            // Modal √∂ffnen
            document.getElementById('identity-modal').classList.remove('hidden');
        }

        function selectIdentity(name) {
            if (!pendingCommentData) return;

            const { id, text, inputField } = pendingCommentData;
            const area = document.getElementById(`comments-area-${id}`);
            
            // Neuen Kommentar einf√ºgen
            const newCommentDiv = document.createElement('div');
            newCommentDiv.innerHTML = renderCommentHtml(name, text).trim(); // trim entfernt whitespaces um das div
            
            area.appendChild(newCommentDiv.firstChild); // firstChild, weil renderCommentHtml schon ein div zur√ºckgibt
            
            // Input leeren & Modal schlie√üen
            inputField.value = '';
            closeIdentityModal();
        }

        function closeIdentityModal() {
            document.getElementById('identity-modal').classList.add('hidden');
            pendingCommentData = null;
        }

        // ---------------------------------------------------------
        // INTERAKTIONEN
        // ---------------------------------------------------------

        function clickReaction(btn, emoji) {
            const countSpan = btn.querySelector('.count-val');
            let current = parseInt(countSpan.innerText) || 0;
            countSpan.innerText = current + 1;
            
            btn.classList.add('bg-teal-50', 'border-teal-400');
            setTimeout(() => btn.classList.remove('bg-teal-50', 'border-teal-400'), 200);
            spawnEmojis(emoji, btn);
        }

        function spawnEmojis(char, target) {
            const rect = target.getBoundingClientRect();
            const center = { x: rect.left + rect.width / 2, y: rect.top };
            for(let i=0; i<6; i++) {
                const el = document.createElement('div');
                el.innerText = char;
                el.style.cssText = `position:fixed;left:${center.x}px;top:${center.y}px;pointer-events:none;font-size:1.5rem;z-index:9999;transition:all 0.8s;`;
                document.body.appendChild(el);
                
                const angle = Math.random() * Math.PI * 2;
                const dx = Math.cos(angle) * 60; 
                const dy = -50 - Math.random() * 80;

                requestAnimationFrame(() => {
                    el.style.transform = `translate(${dx}px, ${dy}px) rotate(${Math.random()*90 - 45}deg) scale(0.5)`;
                    el.style.opacity = '0';
                });
                setTimeout(() => el.remove(), 800);
            }
        }

        // Lightbox
        const lightbox = document.getElementById('lightbox');
        const lightboxImg = document.getElementById('lightbox-img');
        function openLightbox(src) {
            lightboxImg.src = src; lightbox.classList.remove('hidden');
            setTimeout(() => { lightboxImg.classList.remove('scale-95', 'opacity-0'); lightboxImg.classList.add('scale-100', 'opacity-100'); }, 10);
        }
        function closeLightbox() {
            lightboxImg.classList.remove('scale-100', 'opacity-100'); lightboxImg.classList.add('scale-95', 'opacity-0');
            setTimeout(() => { lightbox.classList.add('hidden'); }, 300);
        }

        // Start
        renderFeed();
    </script>
</body>
</html>
